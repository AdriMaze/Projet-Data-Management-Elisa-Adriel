---
title: "On the curvature of the Phillips curve"
format: 
  html:
    toc: true
    toc-depth: 3
    toc-location: left
    code-fold: true
---
# Setup

```{r, message = FALSE, warning = FALSE}
# Basic setup
here::i_am("Projet-Data-Management-Elisa-Adriel.Rproj")

# Libraries
library(vroom)
library(dplyr)
library(knitr)
library(tidyr)
```

# Motivation of the project

The dynamics in the labor market are the most complicated out of all markets, because it mixes the humane reasoning and the economic one. The Phillips curve has always been a reference tool because of the simplicity of the relationship between prices and unemployment it created. This relationship could not only provide an analytically point of view about the conjuncture, but also a policy tool. 
In every economics class, the Phillips curve was said to be negatively slopped, but as one progresses, it realizes that this is less and less the case and that multiple other underlying factors actually drive these two forces. This is what we try to explore today.

# Data and sources

***[Note: at the moment, only OECD database available for me don't know why]{.mark}***

## Sources

Our two sources are from the [OECD Data Explorer's 117 Economic Outlook](https://data-explorer.oecd.org/vis?pg=0&snb=1&vw=ov&df[ds]=dsDisseminateFinalDMZ&df[id]=DSD_EO%40DF_EO&df[ag]=OECD.ECO.MAD&df[vs]=&lb=bt&dq=DEU%2BAUT%2BBEL%2BDNK%2BESP%2BEST%2BFIN%2BFRA%2BGRC%2BHUN%2BISL%2BIRL%2BITA%2BLVA%2BLTU%2BLUX%2BNOR%2BNLD%2BPOL%2BPRT%2BSVK%2BGBR%2BSVN%2BSWE%2BCHE%2BBGR%2BHRV%2BROU.IRS%2BIRCB%2BIRL%2BUN%2BES%2BWSST%2BEE%2BECSA%2BEG%2BHRS%2BLF%2BLFPR1574%2BET%2BET_NA%2BPOP%2BULC%2BPOP1574%2BCPI%2BETPT%2BGDPVTR%2BGDPTR%2BET_ANNPCT%2BTTRADE%2BWRT%2BWAGE%2BPCORE_YTYPCT%2BCPI_YTYPCT%2BUNR%2BPDTY.A&pd=%2C&ly[rw]=REF_AREA&ly[cl]=TIME_PERIOD&ly[rs]=MEASURE&to[TIME_PERIOD]=false&lc=fr) and the [World Development Indicator](https://databank.worldbank.org/source/world-development-indicators#).

```{r, message = FALSE, warning = FALSE}
# Loading data
OECD <- vroom("data/DATA OCDE.csv")
WDI <- vroom("data/DATA WDI.csv")
```

## Necessary data manipulation

All the data in OECD is annual and there are many unnecessary columns. We keep only the reference area, measure, time period and observation value of the measure, respectively named `country`, `measure`, `time` and `value`. 

```{r, message = FALSE, warning = FALSE}
OECD <- OECD |>
  select(`Reference area`, Measure, TIME_PERIOD, OBS_VALUE) |>
  rename(
    country = `Reference area`,
    measure = Measure,
    time = TIME_PERIOD,
    value = OBS_VALUE
  ) |>
  mutate(
    time = as.numeric(time),
    value = as.numeric(value)
  ) |>
  drop_na()
```

WDI data is also annual and we also need to get rid of unnecessary columns. We will also use `pivot_longer` in order to group all the different columns for the different variables in a new `measure` column and their values in the `value` one. Also, `Time` will be renamed as `time`.

```{r, message = FALSE, warning = FALSE}
WDI <- WDI |>
  select(-c(`Time Code`,`Country Code`)) |>
  pivot_longer(
    cols = -c(`Time`,`Country Name`),
    names_to = "measure",
    values_to = "value"
  ) |>
  rename(
    country = `Country Name`,
    time = Time
  ) |>
  mutate(
    time = as.numeric(time),
    value = as.numeric(ifelse(value == "..", NA, value))
  ) |>
  drop_na()
```

We can now merge both datasets:

```{r, message = FALSE, warning = FALSE}
data <- full_join(
    OECD, WDI,
    by = c("country", "measure", "value", "time")
  ) |>
  drop_na()
```


# Introduction to a bit of history

## What is the Phillips curve?

The curve was conceptualized by William Phillips in 1958 in the [Economica]{.mark} journal. He apparently observed the negative relationship between the increase in nominal wages and unemployment between 1861 and 1957.

*[**Fun fact**: a few people actually now the true story behind this curve, but according to a friend of Phillips who then worked at the ECB and passed down this story in the Financial Analysis department, Phillips actually computed the curve ... by hand! In fact, he took the data, created 5 or so averages and observed the negative relationship in the graph. This is the true (yet not so sexy and serious) story behind the "statistical observation" of this curve. Although his work was thereafter taken by other brilliant economist, which found (not so strong though) similar relationships.]{.mark}*

He derived the following relationship:

$$
\frac{\Delta W}{W}=\alpha\cdot U^{-\beta}-\gamma
$$

Where $\frac{\Delta W}{W}$ represents the rate of change of nominal wages and $U \geq 0$ represents unemployment. The rest are parameters. This equation has a very practical theoretical reasoning which serves as a strong foundation for wage bargaining theory, which itself lies in the center of labor market economics. When unemployment increases, the firm has more "supply" of potential workers, therefore, their bargaining power decreases, and so does their wages, which in turns create a decrease in prices, because firms can supply more. Vice-versa if unemployment decreases.


## Historical development

## Actual researches on it

The newest researches go as far as to develop an open-economy Phillips curve, where inflation is influenced by both wage levels and the exchange rate:

$$
\pi_t=\gamma_1 \cdot \mathbb{E}_t[\pi_{t+1}]+\gamma_2 \cdot x_t + \gamma_3 \cdot q_t
$$

Where $\gamma_1$, $\gamma_2$ and $\gamma_3$ are parameters, $\pi_t$ represents domestic inflation and $x_t$ is the (real) output gap and $q_t$ the (real) exchange rate. This equation is based on [Gali & Monacelli (2005)](https://crei.cat/wp-content/uploads/users/pages/roes8739.pdf). See Appendix A for full derivation.

## Improvements there could be (according to us)

# Data visualization

# Data analysis

## Numerical model

# Conclusion

# Appendix

## Appendix A: Derivation of the open economy New Keynesian Phillips Curve (NKPC)

In the classical New Keynesian model, the demand side of the economy yields the CES consumption function:

$$
C_t(i)=\left(\frac{P_t(i)}{P_t} \right)^{-\varepsilon}\cdot C_t
$$
For $i\in[0,1]$ firms. Market clears at $Y_t(i)=C_t(i)$. Firms produce according to a linear production function $Y_t(i)=A_tN_t(i)$ where $a_t\equiv \log{A_t}$ follows an AR(1) process with MA($\infty$) representation $a_t=\sum_{k=0}^{+\infty}{\rho_a^k \epsilon_{t-k}}$. Moreover, firms price *a la Calvo* (1983), where $1-\theta$ (oligopolist) firms can reset prices at level $P_t^*(i)$ in each period, which implies maximizing:

$$
\max_{P_t(i)} {\mathbb{E}_t \left[\sum_{k=0}^{+\infty}{(\beta\theta)^k \Lambda_{t,t+k} Y_{t+k|t}\left(P_t^*(i)-MC_{t+k}P_{t+k} \right)} \right]}
$$
Under the demand constraint $Y_{t+k|t}=\left(\frac{P_t^*(i)}{P_t} \right)^{-\varepsilon}\cdot Y_{t+k}$ and the marginal cost of the firm defined as:

$$
MC_t=(1-\chi) \frac{W_t}{P_t}+\chi S_t P_t^f
$$

Where $S_t$ is the nominal exchange rate and $P_t^f$ is the foreign price index. [$\chi$ represents home bias preference, and therefore a natural index for openness to trade]{.mark} The optimal consumer price index (CPI) inflation condition, where inflation is defined as $\pi_t \equiv p_t-p_{t-1}$, is given by:

$$
\pi_t=\beta \cdot \mathbb{E}_t[\pi_{t+1}]+\kappa \cdot \widehat{mc}_t
$$

Where $\kappa \equiv \frac{(1-\theta)(1-\beta\theta)}{\theta}$. Real marginal cost $\widehat{mc}_t$ can be found by log-linearizing the firms' nominal marginal cost, which holds for every firm due to the linearity of the production function:

$$
\widehat{mc}_t =(1-\chi)\cdot (\hat{w}_t-\hat{p}_t-\hat{a}_t)+\chi\cdot (\hat{s}_t+\hat{p}^f_t-\hat{p}_t) \\
\Leftrightarrow \widehat{mc}^*_t =(\hat{w}_t-\hat{p}_t-\hat{a}_t)+\alpha \cdot \hat{q}_t
$$
Where $\hat{s}_t+\hat{p}^f_t-\hat{p}_t\equiv \hat{q}_t$ is exactly the formula for the real exchange rate, $\widehat{mc}^*_t \equiv \frac{\widehat{mc}_t}{1-\chi}$ and $\alpha \equiv \frac{\chi}{1-\chi}$. This allows to derive the final New Keynesian Phillips Curve (NKPC):

$$
\pi_t =\beta \cdot \mathbb{E}_t[\pi_{t+1}]+\kappa \cdot (\hat{w}_t-\hat{p}_t-\hat{a}_t)+\kappa\alpha \cdot \hat{q}_t\\
$$
Which allow us to derive three different possible NKPC:

$$
\text{NKPC (1):} \quad \pi_t =\gamma_1 \cdot \mathbb{E}_t[\pi_{t+1}]+\gamma_2 \cdot (\hat{w}_t-\hat{p}_t-\hat{a}_t)+\gamma_3 \cdot \hat{q}_t
$$
With parameters $\gamma_1\equiv\beta$, $\gamma_2\equiv \kappa$ and $\gamma_3\equiv\kappa \alpha$.

$$
\text{NKPC (2):} \quad \pi_t =\gamma_1 \cdot \mathbb{E}_t[\pi_{t+1}]+\gamma_2 \cdot (\hat{y}_t-\hat{y}^n_t)+\gamma_3 \cdot \hat{q}_t
$$
Using the fact that [under imperfect competition, the real unit labor cost is equal to the output gap]{.mark} such that $\hat{w}_t-\hat{p}_t-\hat{a}_t=\hat{y}_t-\hat{y}^n_t$, and with parameters $\gamma_1\equiv\beta$, $\gamma_2\equiv \kappa\varphi$ and $\gamma_3\equiv\kappa \alpha$.

$$
\text{NKPC (3):} \quad \pi_t =\gamma_1 \cdot \mathbb{E}_t[\pi_{t+1}]+\gamma_2 \cdot (\hat{u}_t-\hat{u}^n_t)+\gamma_3 \cdot \hat{q}_t
$$
Using [Okun's law]{.mark}, which can be expressed as $-\delta(\hat{y}_t-\hat{y}^n_t)=\hat{u}_t-\hat{u}^n_t$, and with parameters $\gamma_1\equiv\beta$, $\gamma_2\equiv -\frac{\kappa}{\delta}$ and $\gamma_3\equiv\kappa \alpha$.






