labs(
x = "Unemployment rate (%)",
y = "Inflation rate (%)"
) +
theme_minimal()
data_wide <- data_wide %>%
mutate(period = if_else(time < 1990, "Before 1990", "After 1990"))
ncol_page <- 4
nrow_page <- 3
total_pages <- ceiling(length(unique(data_wide$country)) / (ncol_page * nrow_page))
for (i in 1:total_pages) {
p <- data_wide %>%
ggplot(aes(x = unemp.tot.wdi, y = cpi.wdi, color = period)) +
geom_point(alpha = 0.6) +
geom_smooth(method = "lm", formula = y ~ x, se = FALSE) +
facet_wrap_paginate(~ country, ncol = ncol_page, nrow = nrow_page, page = i, scales = "free") +
labs(
title = paste("Phillips Curve: Before vs After 1990 â€” Page", i),
x = "Unemployment rate (%)",
y = "Inflation rate (%)",
color = "Period"
) +
theme_minimal()
print(p)
}
# First page
data_wide |>
filter(cpi.wdi <= 30) |>
select(time, country, cpi.wdi, unemp.tot.wdi) |>
ggplot(aes(x = unemp.tot.wdi, y = cpi.wdi)) +
geom_point() +
geom_smooth(method = "lm", formula = y ~ x, se = FALSE) +
facet_wrap_paginate(~ country, ncol = 4, nrow = 3, page = 1, scales = "free") +
labs(
title = "Phillips Curve",
x = "Unemployment rate (%)",
y = "Inflation rate (%)"
) +
theme_minimal()
# Second page
data_wide |>
filter(cpi.wdi <= 40) |>
select(time, country, cpi.wdi, unemp.tot.wdi) |>
ggplot(aes(x = unemp.tot.wdi, y = cpi.wdi)) +
geom_point() +
geom_smooth(method = "lm", formula = y ~ x, se = FALSE) +
facet_wrap_paginate(~ country, ncol = 4, nrow = 3, page = 2, scales = "free") +
labs(
x = "Unemployment rate (%)",
y = "Inflation rate (%)"
) +
theme_minimal()
# Third page
data_wide |>
filter(cpi.wdi <= 30) |>
select(time, country, cpi.wdi, unemp.tot.wdi) |>
filter(country %in% c("Spain", "Sweden", "Switzerland", "United Kingdom")) |>
ggplot(aes(x = unemp.tot.wdi, y = cpi.wdi)) +
geom_point() +
geom_smooth(method = "lm", formula = y ~ x, se = FALSE) +
facet_wrap(~ country, scales = "free") +
labs(
x = "Unemployment rate (%)",
y = "Inflation rate (%)"
) +
theme_minimal()
# First page
data_wide |>
filter(cpi.wdi <= 30) |>
mutate(
period = if_else(time < 1990, "Before 1990", "After 1990")
) |>
select(time, country, cpi.wdi, unemp.tot.wdi, period) |>
ggplot(aes(x = unemp.tot.wdi, y = cpi.wdi, color = period)) +
geom_point() +
geom_smooth(method = "lm", formula = y ~ x, se = FALSE) +
facet_wrap_paginate(~ country, ncol = 4, nrow = 3, page = 1, scales = "free") +
labs(
title = "Phillips Curve",
x = "Unemployment rate (%)",
y = "Inflation rate (%)"
) +
theme_minimal()
# Second page
data_wide |>
filter(cpi.wdi <= 40) |>
select(time, country, cpi.wdi, unemp.tot.wdi) |>
ggplot(aes(x = unemp.tot.wdi, y = cpi.wdi)) +
geom_point() +
geom_smooth(method = "lm", formula = y ~ x, se = FALSE) +
facet_wrap_paginate(~ country, ncol = 4, nrow = 3, page = 2, scales = "free") +
labs(
x = "Unemployment rate (%)",
y = "Inflation rate (%)"
) +
theme_minimal()
# Third page
data_wide |>
filter(cpi.wdi <= 30) |>
select(time, country, cpi.wdi, unemp.tot.wdi) |>
filter(country %in% c("Spain", "Sweden", "Switzerland", "United Kingdom")) |>
ggplot(aes(x = unemp.tot.wdi, y = cpi.wdi)) +
geom_point() +
geom_smooth(method = "lm", formula = y ~ x, se = FALSE) +
facet_wrap(~ country, scales = "free") +
labs(
x = "Unemployment rate (%)",
y = "Inflation rate (%)"
) +
theme_minimal()
# First page
data_wide |>
filter(cpi.wdi <= 40) |>
select(time, country, cpi.wdi, unemp.tot.wdi) |>
ggplot(aes(x = unemp.tot.wdi, y = cpi.wdi)) +
geom_point() +
geom_smooth(method = "lm", formula = y ~ x, se = FALSE) +
facet_wrap_paginate(~ country, ncol = 4, nrow = 3, page = 1, scales = "free") +
labs(
title = "Phillips Curve",
x = "Unemployment rate (%)",
y = "Inflation rate (%)"
) +
theme_minimal()
# Second page
data_wide |>
filter(cpi.wdi <= 40) |>
select(time, country, cpi.wdi, unemp.tot.wdi) |>
ggplot(aes(x = unemp.tot.wdi, y = cpi.wdi)) +
geom_point() +
geom_smooth(method = "lm", formula = y ~ x, se = FALSE) +
facet_wrap_paginate(~ country, ncol = 4, nrow = 3, page = 2, scales = "free") +
labs(
x = "Unemployment rate (%)",
y = "Inflation rate (%)"
) +
theme_minimal()
# Third page
data_wide |>
filter(cpi.wdi <= 40) |>
select(time, country, cpi.wdi, unemp.tot.wdi) |>
filter(country %in% c("Spain", "Sweden", "Switzerland", "United Kingdom")) |>
ggplot(aes(x = unemp.tot.wdi, y = cpi.wdi)) +
geom_point() +
geom_smooth(method = "lm", formula = y ~ x, se = FALSE) +
facet_wrap(~ country, scales = "free") +
labs(
x = "Unemployment rate (%)",
y = "Inflation rate (%)"
) +
theme_minimal()
# First page
data_wide |>
filter(cpi.wdi <= 40) |>
mutate(
period = if_else(time < 1990, "Before 1990", "After 1990")
) |>
select(time, country, cpi.wdi, unemp.tot.wdi, period) |>
ggplot(aes(x = unemp.tot.wdi, y = cpi.wdi, color = period)) +
geom_point() +
geom_smooth(method = "lm", formula = y ~ x, se = FALSE) +
facet_wrap_paginate(~ country, ncol = 4, nrow = 3, page = 1, scales = "free") +
labs(
title = "Phillips Curve",
x = "Unemployment rate (%)",
y = "Inflation rate (%)"
) +
theme_minimal()
# Second page
data_wide |>
filter(cpi.wdi <= 40) |>
mutate(
period = if_else(time < 1990, "Before 1990", "After 1990")
) |>
select(time, country, cpi.wdi, unemp.tot.wdi) |>
ggplot(aes(x = unemp.tot.wdi, y = cpi.wdi)) +
geom_point() +
geom_smooth(method = "lm", formula = y ~ x, se = FALSE) +
facet_wrap_paginate(~ country, ncol = 4, nrow = 3, page = 2, scales = "free") +
labs(
x = "Unemployment rate (%)",
y = "Inflation rate (%)"
) +
theme_minimal()
# Third page
data_wide |>
filter(cpi.wdi <= 40) |>
mutate(
period = if_else(time < 1990, "Before 1990", "After 1990")
) |>
select(time, country, cpi.wdi, unemp.tot.wdi) |>
filter(country %in% c("Spain", "Sweden", "Switzerland", "United Kingdom")) |>
ggplot(aes(x = unemp.tot.wdi, y = cpi.wdi)) +
geom_point() +
geom_smooth(method = "lm", formula = y ~ x, se = FALSE) +
facet_wrap(~ country, scales = "free") +
labs(
x = "Unemployment rate (%)",
y = "Inflation rate (%)"
) +
theme_minimal()
# First page
data_wide |>
filter(cpi.wdi <= 40) |>
mutate(
period = if_else(time < 1990, "Before 1990", "After 1990")
) |>
select(time, country, cpi.wdi, unemp.tot.wdi, period) |>
ggplot(aes(x = unemp.tot.wdi, y = cpi.wdi, color = period)) +
geom_point() +
geom_smooth(method = "lm", formula = y ~ x, se = FALSE) +
facet_wrap_paginate(~ country, ncol = 4, nrow = 3, page = 1, scales = "free") +
labs(
title = "Phillips Curve",
x = "Unemployment rate (%)",
y = "Inflation rate (%)"
) +
theme_minimal()
# Second page
data_wide |>
filter(cpi.wdi <= 40) |>
mutate(
period = if_else(time < 1990, "Before 1990", "After 1990")
) |>
select(time, country, cpi.wdi, unemp.tot.wdi, period) |>
ggplot(aes(x = unemp.tot.wdi, y = cpi.wdi, color = period)) +
geom_point() +
geom_smooth(method = "lm", formula = y ~ x, se = FALSE) +
facet_wrap_paginate(~ country, ncol = 4, nrow = 3, page = 2, scales = "free") +
labs(
x = "Unemployment rate (%)",
y = "Inflation rate (%)"
) +
theme_minimal()
# Third page
data_wide |>
filter(cpi.wdi <= 40) |>
mutate(
period = if_else(time < 1990, "Before 1990", "After 1990")
) |>
select(time, country, cpi.wdi, unemp.tot.wdi, period) |>
filter(country %in% c("Spain", "Sweden", "Switzerland", "United Kingdom")) |>
ggplot(aes(x = unemp.tot.wdi, y = cpi.wdi, color = period)) +
geom_point() +
geom_smooth(method = "lm", formula = y ~ x, se = FALSE) +
facet_wrap(~ country, scales = "free") +
labs(
x = "Unemployment rate (%)",
y = "Inflation rate (%)"
) +
theme_minimal()
# First page
data_wide |>
filter(cpi.wdi <= 40) |>
mutate(
period = if_else(time < 1990, "Before 1990", "After 1990")
) |>
select(time, country, cpi.wdi, unemp.tot.wdi, period) |>
ggplot(aes(x = unemp.tot.wdi, y = cpi.wdi, color = period)) +
geom_point(alpha = 0.7) +
geom_smooth(method = "lm", formula = y ~ x, se = FALSE) +
facet_wrap_paginate(~ country, ncol = 4, nrow = 3, page = 1, scales = "free") +
labs(
title = "Phillips Curve",
x = "Unemployment rate (%)",
y = "Inflation rate (%)"
) +
theme_minimal()
# Second page
data_wide |>
filter(cpi.wdi <= 40) |>
mutate(
period = if_else(time < 1990, "Before 1990", "After 1990")
) |>
select(time, country, cpi.wdi, unemp.tot.wdi, period) |>
ggplot(aes(x = unemp.tot.wdi, y = cpi.wdi, color = period)) +
geom_point(alpha = 0.7) +
geom_smooth(method = "lm", formula = y ~ x, se = FALSE) +
facet_wrap_paginate(~ country, ncol = 4, nrow = 3, page = 2, scales = "free") +
labs(
x = "Unemployment rate (%)",
y = "Inflation rate (%)"
) +
theme_minimal()
# Third page
data_wide |>
filter(cpi.wdi <= 40) |>
mutate(
period = if_else(time < 1990, "Before 1990", "After 1990")
) |>
select(time, country, cpi.wdi, unemp.tot.wdi, period) |>
filter(country %in% c("Spain", "Sweden", "Switzerland", "United Kingdom")) |>
ggplot(aes(x = unemp.tot.wdi, y = cpi.wdi, color = period)) +
geom_point(alpha = 0.7) +
geom_smooth(method = "lm", formula = y ~ x, se = FALSE) +
facet_wrap(~ country, scales = "free") +
labs(
x = "Unemployment rate (%)",
y = "Inflation rate (%)"
) +
theme_minimal()
# First page
data_wide |>
filter(cpi.wdi <= 40) |>
select(time, country, cpi.wdi, unemp.tot.wdi) |>
ggplot(aes(x = unemp.tot.wdi, y = cpi.wdi)) +
geom_point(alpha = 0.7) +
geom_smooth(method = "lm", formula = y ~ x, se = FALSE, color = "black") +
facet_wrap_paginate(~ country, ncol = 4, nrow = 3, page = 1, scales = "free") +
labs(
title = "Phillips Curve",
x = "Unemployment rate (%)",
y = "Inflation rate (%)"
) +
theme_minimal()
# Second page
data_wide |>
filter(cpi.wdi <= 40) |>
select(time, country, cpi.wdi, unemp.tot.wdi) |>
ggplot(aes(x = unemp.tot.wdi, y = cpi.wdi)) +
geom_point(alpha = 0.7) +
geom_smooth(method = "lm", formula = y ~ x, se = FALSE, color = "black") +
facet_wrap_paginate(~ country, ncol = 4, nrow = 3, page = 2, scales = "free") +
labs(
x = "Unemployment rate (%)",
y = "Inflation rate (%)"
) +
theme_minimal()
# Third page
data_wide |>
filter(cpi.wdi <= 40) |>
select(time, country, cpi.wdi, unemp.tot.wdi) |>
filter(country %in% c("Spain", "Sweden", "Switzerland", "United Kingdom")) |>
ggplot(aes(x = unemp.tot.wdi, y = cpi.wdi)) +
geom_point(alpha = 0.7) +
geom_smooth(method = "lm", formula = y ~ x, se = FALSE, color = "black") +
facet_wrap(~ country, scales = "free") +
labs(
x = "Unemployment rate (%)",
y = "Inflation rate (%)"
) +
theme_minimal()
# First page
data_wide |>
filter(cpi.wdi <= 40) |>
mutate(
period = if_else(time < 1990, "Before 1990", "After 1990")
) |>
select(time, country, cpi.wdi, unemp.tot.wdi, period) |>
ggplot(aes(x = unemp.tot.wdi, y = cpi.wdi, color = period)) +
geom_point(alpha = 0.7) +
geom_smooth(method = "lm", formula = y ~ x, se = FALSE) +
facet_wrap_paginate(~ country, ncol = 4, nrow = 3, page = 1, scales = "free") +
labs(
title = "Phillips Curve",
x = "Unemployment rate (%)",
y = "Inflation rate (%)"
) +
scale_color_manual(values = c(
"Before 1990" = "grey70",
"After 1990"  = "black"
)) +
theme_minimal()
# Second page
data_wide |>
filter(cpi.wdi <= 40) |>
mutate(
period = if_else(time < 1990, "Before 1990", "After 1990")
) |>
select(time, country, cpi.wdi, unemp.tot.wdi, period) |>
ggplot(aes(x = unemp.tot.wdi, y = cpi.wdi, color = period)) +
geom_point(alpha = 0.7) +
geom_smooth(method = "lm", formula = y ~ x, se = FALSE) +
facet_wrap_paginate(~ country, ncol = 4, nrow = 3, page = 2, scales = "free") +
labs(
x = "Unemployment rate (%)",
y = "Inflation rate (%)"
) +
theme_minimal()
# Third page
data_wide |>
filter(cpi.wdi <= 40) |>
mutate(
period = if_else(time < 1990, "Before 1990", "After 1990")
) |>
select(time, country, cpi.wdi, unemp.tot.wdi, period) |>
filter(country %in% c("Spain", "Sweden", "Switzerland", "United Kingdom")) |>
ggplot(aes(x = unemp.tot.wdi, y = cpi.wdi, color = period)) +
geom_point(alpha = 0.7) +
geom_smooth(method = "lm", formula = y ~ x, se = FALSE) +
facet_wrap(~ country, scales = "free") +
labs(
x = "Unemployment rate (%)",
y = "Inflation rate (%)"
) +
theme_minimal()
# First page
data_wide |>
filter(cpi.wdi <= 40) |>
mutate(
period = if_else(time < 1990, "Before 1990", "After 1990")
) |>
select(time, country, cpi.wdi, unemp.tot.wdi, period) |>
ggplot(aes(x = unemp.tot.wdi, y = cpi.wdi, color = period)) +
geom_point(alpha = 0.7) +
geom_smooth(method = "lm", formula = y ~ x, se = FALSE) +
facet_wrap_paginate(~ country, ncol = 4, nrow = 3, page = 1, scales = "free") +
labs(
title = "Phillips Curve",
x = "Unemployment rate (%)",
y = "Inflation rate (%)"
) +
scale_color_manual(values = c(
"Before 1990" = "darkgrey",
"After 1990"  = "black"
)) +
theme_minimal()
# Second page
data_wide |>
filter(cpi.wdi <= 40) |>
mutate(
period = if_else(time < 1990, "Before 1990", "After 1990")
) |>
select(time, country, cpi.wdi, unemp.tot.wdi, period) |>
ggplot(aes(x = unemp.tot.wdi, y = cpi.wdi, color = period)) +
geom_point(alpha = 0.7) +
geom_smooth(method = "lm", formula = y ~ x, se = FALSE) +
facet_wrap_paginate(~ country, ncol = 4, nrow = 3, page = 2, scales = "free") +
labs(
x = "Unemployment rate (%)",
y = "Inflation rate (%)"
) +
theme_minimal()
# Third page
data_wide |>
filter(cpi.wdi <= 40) |>
mutate(
period = if_else(time < 1990, "Before 1990", "After 1990")
) |>
select(time, country, cpi.wdi, unemp.tot.wdi, period) |>
filter(country %in% c("Spain", "Sweden", "Switzerland", "United Kingdom")) |>
ggplot(aes(x = unemp.tot.wdi, y = cpi.wdi, color = period)) +
geom_point(alpha = 0.7) +
geom_smooth(method = "lm", formula = y ~ x, se = FALSE) +
facet_wrap(~ country, scales = "free") +
labs(
x = "Unemployment rate (%)",
y = "Inflation rate (%)"
) +
theme_minimal()
# First page
data_wide |>
filter(cpi.wdi <= 40) |>
mutate(
period = if_else(time < 1990, "Before 1990", "After 1990")
) |>
select(time, country, cpi.wdi, unemp.tot.wdi, period) |>
ggplot(aes(x = unemp.tot.wdi, y = cpi.wdi, color = period)) +
geom_point(alpha = 0.7) +
geom_smooth(method = "lm", formula = y ~ x, se = FALSE) +
facet_wrap_paginate(~ country, ncol = 4, nrow = 3, page = 1, scales = "free") +
labs(
title = "Phillips Curve",
x = "Unemployment rate (%)",
y = "Inflation rate (%)"
) +
scale_color_manual(values = c(
"Before 1990" = "darkgrey",
"After 1990"  = "black"
)) +
theme_minimal()
# Second page
data_wide |>
filter(cpi.wdi <= 40) |>
mutate(
period = if_else(time < 1990, "Before 1990", "After 1990")
) |>
select(time, country, cpi.wdi, unemp.tot.wdi, period) |>
ggplot(aes(x = unemp.tot.wdi, y = cpi.wdi, color = period)) +
geom_point(alpha = 0.7) +
geom_smooth(method = "lm", formula = y ~ x, se = FALSE) +
facet_wrap_paginate(~ country, ncol = 4, nrow = 3, page = 2, scales = "free") +
labs(
x = "Unemployment rate (%)",
y = "Inflation rate (%)"
) +
scale_color_manual(values = c(
"Before 1990" = "darkgrey",
"After 1990"  = "black"
)) +
theme_minimal()
# Third page
data_wide |>
filter(cpi.wdi <= 40) |>
mutate(
period = if_else(time < 1990, "Before 1990", "After 1990")
) |>
select(time, country, cpi.wdi, unemp.tot.wdi, period) |>
filter(country %in% c("Spain", "Sweden", "Switzerland", "United Kingdom")) |>
ggplot(aes(x = unemp.tot.wdi, y = cpi.wdi, color = period)) +
geom_point(alpha = 0.7) +
geom_smooth(method = "lm", formula = y ~ x, se = FALSE) +
facet_wrap(~ country, scales = "free") +
labs(
x = "Unemployment rate (%)",
y = "Inflation rate (%)"
) +
scale_color_manual(values = c(
"Before 1990" = "darkgrey",
"After 1990"  = "black"
)) +
theme_minimal()
